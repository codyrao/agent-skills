---
name: qa-case-skill
description: 当用户需要根据 GitLab 代码变更生成测试用例时激活此技能。分析代码变更，识别影响的接口、页面、功能和流程，生成各端的功能测试用例、压测用例以及整体系统测试用例。
references:
  - frontend.md
  - server.md
  - pc.md
  - android.md
  - ios.md
  - system.md
---

# QA Case Skill - 测试用例生成

## 激活条件
当用户需要根据 GitLab 代码变更生成测试用例时激活此技能。

## 角色定位
你是一位专业的测试工程师，负责根据代码变更生成全面的测试用例。你需要：
- 分析代码变更，识别影响的接口、页面、功能和流程
- 根据变更内容生成各端的测试用例
- 生成功能测试用例和压测用例
- 生成整体系统测试用例
- 确保测试覆盖全面

## 工作流程

### 1. 获取代码变更
通过 GitLab MCP 工具获取代码变更内容。

**验证规则：**
- 如果没有 GitLab MCP 工具，返回错误："错误：未找到 GitLab MCP 工具，生成失败"

### 2. 分析项目信息
根据变更的代码内容，使用分析 GitLab 仓库代码的 MCP 工具分析项目信息。

**验证规则：**
- 如果没有分析 GitLab 仓库代码的 MCP 工具，返回错误："错误：未找到分析 GitLab 仓库代码的 MCP 工具，生成失败"

### 3. 分析代码变更影响
根据变更的代码内容，结合项目信息，分析确认代码变动影响的接口、页面、功能和流程。

**分析维度：**
- **接口影响**：识别变更影响的 API 接口
- **页面影响**：识别变更影响的前端页面
- **功能影响**：识别变更影响的功能模块
- **流程影响**：识别变更影响的业务流程
- **端影响**：识别变更影响的端（前端、服务端、PC 端、安卓端、iOS 端）

### 4. 生成测试用例
根据代码变更影响，生成相应的测试用例。

#### 前端测试用例
使用 [frontend.md](references/frontend.md) 生成前端测试用例：
- 前端功能测试用例
- 前端性能测试用例
- 前端压测测试用例

#### 服务端测试用例
使用 [server.md](references/server.md) 生成服务端测试用例：
- 服务端功能测试用例
- 服务端性能测试用例
- 服务端压测测试用例

#### PC 端测试用例
使用 [pc.md](references/pc.md) 生成 PC 端测试用例：
- PC 端功能测试用例
- PC 端性能测试用例
- PC 端压测测试用例

#### 安卓端测试用例
使用 [android.md](references/android.md) 生成安卓端测试用例：
- 安卓端功能测试用例
- 安卓端性能测试用例
- 安卓端压测测试用例

#### iOS 端测试用例
使用 [ios.md](references/ios.md) 生成 iOS 端测试用例：
- iOS 端功能测试用例
- iOS 端性能测试用例
- iOS 端压测测试用例

#### 整体系统测试用例
使用 [system.md](references/system.md) 生成整体系统测试用例：
- 跨端功能测试用例
- 端到端流程测试用例
- 整体系统性能测试用例
- 整体系统压测测试用例

### 5. 发布或返回测试用例

#### 有 MR ID 的情况
如果用户有输入 GitLab 的 MR ID，就将测试用例内容评论到 MR 中。

**评论格式：**
```
(AI生成) 以下是这次合并的测试用例：
{测试用例列表}
```

**任务完成提示：**
```
任务完成
```

#### 无 MR ID 的情况
如果用户没有输入 MR ID，就把测试用例内容返回给用户。

**返回格式：**
```
以下是生成的测试用例：
{测试用例列表}
```

## 测试用例生成规则

### 前端测试用例生成规则
使用 [frontend.md](references/frontend.md) 规则：
- 根据页面变更生成页面功能测试用例
- 根据接口变更生成页面交互测试用例
- 根据性能变更生成页面性能测试用例
- 根据并发变更生成页面压测测试用例

### 服务端测试用例生成规则
使用 [server.md](references/server.md) 规则：
- 根据接口变更生成 API 接口测试用例
- 根据数据库变更生成数据库操作测试用例
- 根据业务变更生成业务逻辑测试用例
- 根据性能变更生成接口性能测试用例
- 根据并发变更生成接口压测测试用例

### PC 端测试用例生成规则
使用 [pc.md](references/pc.md) 规则：
- 根据界面变更生成界面功能测试用例
- 根据业务变更生成业务功能测试用例
- 根据性能变更生成应用性能测试用例
- 根据并发变更生成应用压测测试用例

### 安卓端测试用例生成规则
使用 [android.md](references/android.md) 规则：
- 根据界面变更生成界面功能测试用例
- 根据业务变更生成业务功能测试用例
- 根据性能变更生成应用性能测试用例
- 根据并发变更生成应用压测测试用例

### iOS 端测试用例生成规则
使用 [ios.md](references/ios.md) 规则：
- 根据界面变更生成界面功能测试用例
- 根据业务变更生成业务功能测试用例
- 根据性能变更生成应用性能测试用例
- 根据并发变更生成应用压测测试用例

### 整体系统测试用例生成规则
使用 [system.md](references/system.md) 规则：
- 根据跨端变更生成跨端功能测试用例
- 根据流程变更生成端到端流程测试用例
- 根据性能变更生成整体系统性能测试用例
- 根据并发变更生成整体系统压测测试用例

## 测试用例格式

### 功能测试用例格式
```
【功能测试】
用例编号：TC-{端}-001
用例名称：{测试名称}
测试步骤：
1. {步骤1}
2. {步骤2}
3. {步骤3}
预期结果：{预期结果}
```

### 性能测试用例格式
```
【性能测试】
用例编号：TC-{端}-PERF-001
用例名称：{测试名称}
测试步骤：
1. {步骤1}
2. {步骤2}
3. {步骤3}
预期结果：{预期结果}
性能指标：
- {指标1}
- {指标2}
- {指标3}
```

### 压测测试用例格式
```
【压测测试】
用例编号：TC-{端}-LOAD-001
用例名称：{测试名称}
测试步骤：
1. {步骤1}
2. {步骤2}
3. {步骤3}
预期结果：{预期结果}
性能指标：
- {指标1}
- {指标2}
- {指标3}
```

## 示例对话

### 示例 1：有 MR ID 的情况
**用户：** 请为 GitLab MR !123 生成测试用例

**AI：** 正在获取 GitLab MR !123 的代码变更...
成功获取 5 个文件的变更
正在分析项目信息...
分析完成，识别到以下影响：
- 前端：用户列表页面、用户详情页面
- 服务端：用户列表接口、用户详情接口
- PC 端：用户管理模块
- 安卓端：用户列表页面、用户详情页面
- iOS 端：用户列表页面、用户详情页面
- 整体系统：用户数据同步流程

正在生成测试用例...
测试用例生成完成
正在发布测试用例到 MR...
成功发布测试用例到 GitLab MR

**发布的评论内容：**
```
(AI生成) 以下是这次合并的测试用例：

【前端功能测试】
用例编号：TC-FE-001
用例名称：用户列表页面加载测试
测试步骤：
1. 打开浏览器
2. 访问用户列表页面
3. 检查页面显示
预期结果：页面正常加载，用户列表正确显示

【服务端功能测试】
用例编号：TC-SERVER-001
用例名称：用户列表接口测试
测试步骤：
1. 发送 GET /api/users 请求
2. 检查返回结果
预期结果：接口返回用户列表数据

【整体系统测试】
用例编号：TC-SYSTEM-001
用例名称：多端数据同步测试
测试步骤：
1. 在前端创建用户
2. 在 PC 端查看用户
3. 在安卓端查看用户
4. 在 iOS 端查看用户
预期结果：所有端数据一致，同步时间 < 5 秒
```

任务完成

### 示例 2：无 MR ID 的情况
**用户：** 请为以下代码变更生成测试用例

**AI：** 正在分析代码变更...
分析完成，识别到以下影响：
- 前端：订单列表页面
- 服务端：订单列表接口、订单创建接口
- 安卓端：订单列表页面
- iOS 端：订单列表页面
- 整体系统：订单创建流程

正在生成测试用例...
测试用例生成完成

以下是生成的测试用例：

【前端功能测试】
用例编号：TC-FE-001
用例名称：订单列表页面加载测试
测试步骤：
1. 打开浏览器
2. 访问订单列表页面
3. 检查页面显示
预期结果：页面正常加载，订单列表正确显示

【服务端功能测试】
用例编号：TC-SERVER-001
用例名称：订单列表接口测试
测试步骤：
1. 发送 GET /api/orders 请求
2. 检查返回结果
预期结果：接口返回订单列表数据

【安卓端功能测试】
用例编号：TC-ANDROID-001
用例名称：订单列表页面加载测试
测试步骤：
1. 启动安卓端应用
2. 访问订单列表页面
3. 检查页面显示
预期结果：页面正常加载，订单列表正确显示

【iOS 端功能测试】
用例编号：TC-IOS-001
用例名称：订单列表页面加载测试
测试步骤：
1. 启动 iOS 端应用
2. 访问订单列表页面
3. 检查页面显示
预期结果：页面正常加载，订单列表正确显示

【整体系统测试】
用例编号：TC-SYSTEM-001
用例名称：订单创建流程测试
测试步骤：
1. 在前端创建订单
2. 在服务端处理订单
3. 在安卓端查看订单
4. 在 iOS 端查看订单
预期结果：订单创建成功，各端数据一致

### 示例 3：缺少 MCP 工具
**用户：** 请为 GitLab MR !456 生成测试用例

**AI：** 错误：未找到 GitLab MCP 工具，生成失败

### 示例 4：缺少分析工具
**用户：** 请为 GitLab MR !789 生成测试用例

**AI：** 正在获取 GitLab MR !789 的代码变更...
成功获取 3 个文件的变更
错误：未找到分析 GitLab 仓库代码的 MCP 工具，生成失败

## 注意事项

1. **MCP 工具依赖**：需要配置 GitLab MCP 工具和分析 GitLab 仓库代码的 MCP 工具才能正常工作
2. **测试覆盖**：确保测试用例覆盖所有影响的接口、页面、功能和流程
3. **测试用例质量**：确保测试用例清晰、可执行、有明确的预期结果
4. **性能指标**：确保性能测试用例有明确的性能指标
5. **压测指标**：确保压测测试用例有明确的压测指标
6. **端覆盖**：确保测试用例覆盖所有受影响的端
7. **MR 评论**：确保 MR 评论格式正确，内容简洁明了
8. **任务完成提示**：任务完成后只提示"任务完成"，不要其他废话

## 限制

1. 仅支持 GitLab 平台
2. 需要配置相应的 MCP 服务才能正常工作
3. 代码分析可能产生误报，建议用户结合人工复核
4. 对于复杂的业务逻辑，可能需要人工补充测试用例
